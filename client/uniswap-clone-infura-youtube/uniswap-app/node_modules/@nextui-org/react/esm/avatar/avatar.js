import a,{useMemo as t,useState as r,useRef as s,useEffect as e}from"react";import{useFocusRing as o}from"@react-aria/focus";import{mergeProps as i}from"@react-aria/utils";import{useDOMRef as n}from"../utils/dom";import{__DEV__ as l}from"../utils/assertion";import c from"./avatar.styles";import m from"../utils/clsx";import{jsx as u}from"react/jsx-runtime";import{jsxs as p}from"react/jsx-runtime";const v=a=>(null==a?void 0:a.length)<=4?a:null==a?void 0:a.slice(0,3);export const Avatar=a.forwardRef(((a,l)=>{const{as:x,src:d,css:f,text:N,icon:g,alt:b,className:y,...A}=a,h=n(l),j=!d,[F,V]=r(!1),w=s(null),{isFocusVisible:I,focusProps:L}=o();e((()=>{var a;(null==w||null==(a=w.current)?void 0:a.complete)&&V(!0)}),[]);const P=t((()=>!F&&d?"loading":"ready"),[d,F]);return p(c,{ref:h,as:x,...i(A,L),className:m({"only-text-avatar":j},y),"data-state":P,isFocusVisible:I,css:i("button"===x?{appearance:"none",outline:"none",border:"none",cursor:"pointer"}:{},f),children:[u("span",{className:"nextui-avatar-bg"}),!j&&u("img",{ref:w,className:m("nextui-avatar-img",`nextui-avatar--${P}`,{"nextui-avatar-ready":F}),src:d,alt:b,"data-state":P,onLoad:()=>V(!0)}),j&&!g&&N&&u("span",{className:"nextui-avatar-text",children:v(N)}),g&&u("span",{className:"nextui-avatar-icon",children:g})]})}));l&&(Avatar.displayName="NextUI.Avatar"),Avatar.toString=()=>".nextui-avatar";export default Avatar;