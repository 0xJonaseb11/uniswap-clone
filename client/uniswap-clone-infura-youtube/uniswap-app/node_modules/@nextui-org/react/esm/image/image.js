import t,{useEffect as e,useMemo as r,useState as o}from"react";import a from"./image.skeleton";import i from"../use-real-shape";import s from"../use-current-state";import m from"../use-resize";import{useDOMRef as n}from"../utils/dom";import{__DEV__ as c}from"../utils/assertion";import{StyledImage as u,StyledImageContainer as l}from"./image.styles";import p from"../utils/clsx";import{jsx as f}from"react/jsx-runtime";import{jsxs as d}from"react/jsx-runtime";export const Image=t.forwardRef(((t,c)=>{const{src:g,width:h,height:x,showSkeleton:w=!0,className:y,maxDelay:j=3e3,autoResize:I=!1,objectFit:N="scale-down",containerCss:b,css:T,...$}=t,k=n(c),[z,F]=o(!0),[R,S]=o(w),{w:C,h:D}=r((()=>({w:h?"number"==typeof h?`${h}px`:h:"auto",h:x?"number"==typeof x?`${x}px`:x:"auto"})),[h,x]),[L,U,q]=s(D),[v,A]=i(k),B=w&&!!h&&!!x;e((()=>{k.current&&k.current.complete&&(F(!1),S(!1))})),e((()=>{const t=setTimeout((()=>{B&&S(!1),clearTimeout(t)}),j);return()=>clearTimeout(t)}),[z]),e((()=>{if(!I)return;const t=0===v.width,e="auto"===q.current;!t&&h&&x&&(v.width<h?!e&&U("auto"):e&&U(D))}),[v,h]),m((()=>{I&&A()}));const E=r((()=>z?"loading":"ready"),[z]);return d(l,{className:p("nextui-image-container",`nextui-image--${E}`,y),"data-state":E,ready:!z||R,css:{width:C,height:L,...b},children:[R&&f(a,{opacity:1}),f(u,{ref:k,className:"nextui-image",width:h,height:x,onLoad:()=>{F(!1)},src:g,"data-state":E,alt:t.alt||"",css:{objectFit:N,...T},...$})]})}));c&&(Image.displayName="NextUI.Image"),Image.toString=()=>".nextui-image";export default t.memo(Image);